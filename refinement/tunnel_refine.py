import json
import os
from Bio.PDB.MMCIFParser import MMCIFParser
from Bio.PDB.NeighborSearch import NeighborSearch
from Bio.PDB import Selection
import numpy as np
import open3d as o3d
from open3d import core as o3c
from mendeleev import element

#TODO : Remove ions and non-standard residues when refining the tunnel

refined_tunnel_coordinates = {
    "3JAH": [
        [299.647, 283.065, 275.262],
        [299.620, 283.023, 275.635],
        [299.593, 282.980, 276.006],
        [299.566, 282.938, 276.373],
        [299.539, 282.897, 276.735],
        [299.513, 282.856, 277.089],
        [299.487, 282.816, 277.433],
        [299.462, 282.778, 277.765],
        [299.439, 282.740, 278.084],
        [299.416, 282.704, 278.388],
        [299.394, 282.670, 278.674],
        [299.373, 282.638, 278.941],
        [299.354, 282.607, 279.187],
        [299.336, 282.579, 279.410],
        [299.320, 282.553, 279.607],
        [299.306, 282.529, 279.778],
        [299.293, 282.509, 279.920],
        [299.282, 282.491, 280.034],
        [299.272, 282.475, 280.123],
        [299.263, 282.460, 280.188],
        [299.255, 282.448, 280.233],
        [299.246, 282.436, 280.258],
        [299.237, 282.426, 280.267],
        [299.228, 282.415, 280.262],
        [299.217, 282.405, 280.245],
        [299.204, 282.395, 280.217],
        [299.190, 282.384, 280.183],
        [299.174, 282.372, 280.142],
        [299.154, 282.359, 280.099],
        [299.132, 282.344, 280.055],
        [299.106, 282.328, 280.012],
        [299.077, 282.309, 279.972],
        [299.043, 282.287, 279.937],
        [299.007, 282.263, 279.906],
        [298.967, 282.237, 279.879],
        [298.925, 282.207, 279.856],
        [298.880, 282.175, 279.836],
        [298.834, 282.140, 279.818],
        [298.787, 282.103, 279.804],
        [298.739, 282.062, 279.791],
        [298.691, 282.019, 279.781],
        [298.643, 281.972, 279.772],
        [298.595, 281.922, 279.765],
        [298.548, 281.869, 279.759],
        [298.503, 281.813, 279.753],
        [298.460, 281.754, 279.748],
        [298.418, 281.691, 279.743],
        [298.380, 281.625, 279.738],
        [298.344, 281.556, 279.734],
        [298.311, 281.484, 279.729],
        [298.280, 281.409, 279.725],
        [298.252, 281.332, 279.722],
        [298.227, 281.253, 279.719],
        [298.205, 281.173, 279.718],
        [298.186, 281.091, 279.717],
        [298.169, 281.007, 279.718],
        [298.156, 280.923, 279.720],
        [298.145, 280.838, 279.724],
        [298.138, 280.752, 279.730],
        [298.133, 280.666, 279.738],
        [298.132, 280.580, 279.747],
        [298.133, 280.495, 279.759],
        [298.138, 280.410, 279.774],
        [298.146, 280.325, 279.791],
        [298.156, 280.239, 279.809],
        [298.169, 280.153, 279.830],
        [298.185, 280.065, 279.852],
        [298.203, 279.975, 279.875],
        [298.223, 279.882, 279.900],
        [298.244, 279.787, 279.925],
        [298.268, 279.688, 279.952],
        [298.293, 279.585, 279.978],
        [298.319, 279.477, 280.005],
        [298.347, 279.365, 280.032],
        [298.376, 279.246, 280.059],
        [298.406, 279.122, 280.085],
        [298.436, 278.991, 280.111],
        [298.467, 278.853, 280.135],
        [298.498, 278.710, 280.159],
        [298.529, 278.561, 280.182],
        [298.560, 278.409, 280.204],
        [298.591, 278.256, 280.224],
        [298.621, 278.102, 280.244],
        [298.651, 277.949, 280.262],
        [298.679, 277.799, 280.279],
        [298.706, 277.652, 280.295],
        [298.732, 277.512, 280.309],
        [298.756, 277.378, 280.322],
        [298.778, 277.252, 280.334],
        [298.797, 277.136, 280.343],
        [298.815, 277.031, 280.352],
        [298.830, 276.939, 280.358],
        [298.841, 276.860, 280.363],
        [298.850, 276.796, 280.367],
        [298.857, 276.745, 280.369],
        [298.862, 276.705, 280.369],
        [298.864, 276.676, 280.369],
        [298.865, 276.657, 280.367],
        [298.865, 276.645, 280.365],
        [298.865, 276.641, 280.362],
        [298.863, 276.642, 280.359],
        [298.862, 276.649, 280.355],
        [298.860, 276.659, 280.351],
        [298.859, 276.671, 280.347],
        [298.859, 276.684, 280.343],
        [298.860, 276.698, 280.339],
        [298.863, 276.710, 280.336],
        [298.867, 276.720, 280.334],
        [298.873, 276.726, 280.332],
        [298.878, 276.729, 280.330],
        [298.883, 276.728, 280.328],
        [298.885, 276.723, 280.326],
        [298.882, 276.713, 280.322],
        [298.875, 276.699, 280.317],
        [298.860, 276.679, 280.309],
        [298.836, 276.653, 280.300],
        [298.803, 276.621, 280.287],
        [298.759, 276.583, 280.272],
        [298.701, 276.539, 280.252],
        [298.630, 276.487, 280.229],
        [298.543, 276.429, 280.201],
        [298.438, 276.362, 280.168],
        [298.316, 276.288, 280.129],
        [298.174, 276.205, 280.085],
        [298.015, 276.116, 280.036],
        [297.842, 276.021, 279.982],
        [297.658, 275.922, 279.925],
        [297.466, 275.821, 279.866],
        [297.268, 275.718, 279.804],
        [297.068, 275.615, 279.741],
        [296.868, 275.513, 279.678],
        [296.671, 275.414, 279.615],
        [296.480, 275.319, 279.553],
        [296.298, 275.230, 279.494],
        [296.128, 275.147, 279.436],
        [295.972, 275.073, 279.383],
        [295.834, 275.009, 279.333],
        [295.717, 274.955, 279.288],
        [295.622, 274.914, 279.250],
        [295.549, 274.884, 279.216],
        [295.495, 274.864, 279.189],
        [295.457, 274.854, 279.166],
        [295.434, 274.851, 279.149],
        [295.421, 274.855, 279.136],
        [295.417, 274.863, 279.128],
        [295.419, 274.876, 279.124],
        [295.424, 274.891, 279.124],
        [295.430, 274.907, 279.128],
        [295.434, 274.922, 279.135],
        [295.433, 274.937, 279.146],
        [295.424, 274.948, 279.159],
        [295.406, 274.955, 279.176],
        [295.375, 274.957, 279.194],
        [295.329, 274.952, 279.216],
        [295.267, 274.941, 279.239],
        [295.192, 274.923, 279.264],
        [295.106, 274.900, 279.290],
        [295.011, 274.872, 279.318],
        [294.908, 274.841, 279.347],
        [294.801, 274.806, 279.376],
        [294.691, 274.770, 279.406],
        [294.580, 274.732, 279.437],
        [294.470, 274.694, 279.467],
        [294.363, 274.656, 279.497],
        [294.262, 274.619, 279.527],
        [294.169, 274.584, 279.555],
        [294.085, 274.551, 279.583],
        [294.013, 274.523, 279.609],
        [293.954, 274.498, 279.634],
        [293.911, 274.478, 279.657],
        [293.880, 274.462, 279.678],
        [293.861, 274.451, 279.697],
        [293.852, 274.443, 279.713],
        [293.851, 274.438, 279.726],
        [293.858, 274.437, 279.735],
        [293.869, 274.438, 279.742],
        [293.885, 274.442, 279.744],
        [293.902, 274.447, 279.742],
        [293.920, 274.455, 279.736],
        [293.937, 274.463, 279.725],
        [293.952, 274.473, 279.709],
        [293.962, 274.483, 279.687],
        [293.966, 274.494, 279.660],
        [293.963, 274.504, 279.628],
        [293.952, 274.514, 279.589],
        [293.931, 274.523, 279.545],
        [293.903, 274.530, 279.497],
        [293.866, 274.535, 279.447],
        [293.821, 274.536, 279.394],
        [293.769, 274.534, 279.341],
        [293.709, 274.526, 279.288],
        [293.643, 274.513, 279.237],
        [293.569, 274.494, 279.188],
        [293.489, 274.468, 279.142],
        [293.402, 274.435, 279.101],
        [293.309, 274.393, 279.066],
        [293.210, 274.342, 279.038],
        [293.106, 274.282, 279.017],
        [292.996, 274.211, 279.006],
        [292.881, 274.129, 279.004],
        [292.761, 274.037, 279.012],
        [292.638, 273.936, 279.028],
        [292.511, 273.828, 279.051],
        [292.381, 273.714, 279.081],
        [292.250, 273.596, 279.117],
        [292.117, 273.475, 279.157],
        [291.983, 273.353, 279.200],
        [291.849, 273.231, 279.247],
        [291.716, 273.110, 279.295],
        [291.584, 272.993, 279.343],
        [291.454, 272.881, 279.392],
        [291.326, 272.774, 279.439],
        [291.202, 272.675, 279.484],
        [291.081, 272.585, 279.525],
        [290.964, 272.506, 279.563],
        [290.853, 272.437, 279.596],
        [290.745, 272.377, 279.625],
        [290.643, 272.327, 279.651],
        [290.544, 272.285, 279.673],
        [290.450, 272.249, 279.693],
        [290.361, 272.220, 279.711],
        [290.275, 272.196, 279.726],
        [290.194, 272.176, 279.740],
        [290.116, 272.159, 279.753],
        [290.043, 272.145, 279.766],
        [289.973, 272.133, 279.778],
        [289.907, 272.121, 279.791],
        [289.845, 272.109, 279.804],
        [289.787, 272.095, 279.818],
        [289.732, 272.080, 279.833],
        [289.680, 272.062, 279.850],
        [289.632, 272.042, 279.869],
        [289.587, 272.020, 279.889],
        [289.546, 271.997, 279.910],
        [289.507, 271.973, 279.933],
        [289.472, 271.948, 279.956],
        [289.439, 271.923, 279.981],
        [289.410, 271.898, 280.006],
        [289.383, 271.874, 280.032],
        [289.360, 271.851, 280.059],
        [289.339, 271.830, 280.086],
        [289.320, 271.810, 280.114],
        [289.305, 271.792, 280.142],
        [289.291, 271.777, 280.170],
        [289.280, 271.765, 280.198],
        [289.272, 271.756, 280.226],
        [289.265, 271.750, 280.253],
        [289.259, 271.747, 280.279],
        [289.253, 271.745, 280.304],
        [289.248, 271.745, 280.327],
        [289.241, 271.747, 280.347],
        [289.232, 271.749, 280.364],
        [289.222, 271.751, 280.378],
        [289.208, 271.753, 280.388],
        [289.191, 271.754, 280.393],
        [289.170, 271.755, 280.394],
        [289.144, 271.754, 280.389],
        [289.112, 271.750, 280.379],
        [289.074, 271.745, 280.363],
        [289.030, 271.736, 280.339],
        [288.978, 271.725, 280.309],
        [288.918, 271.709, 280.273],
        [288.851, 271.689, 280.231],
        [288.777, 271.664, 280.186],
        [288.695, 271.634, 280.139],
        [288.605, 271.598, 280.092],
        [288.508, 271.556, 280.044],
        [288.403, 271.507, 279.999],
        [288.291, 271.450, 279.957],
        [288.172, 271.386, 279.919],
        [288.045, 271.313, 279.887],
        [287.910, 271.231, 279.862],
        [287.768, 271.140, 279.846],
        [287.619, 271.039, 279.839],
        [287.462, 270.927, 279.844],
        [287.299, 270.804, 279.862],
        [287.128, 270.672, 279.891],
        [286.953, 270.530, 279.931],
        [286.774, 270.382, 279.980],
        [286.594, 270.229, 280.037],
        [286.414, 270.073, 280.099],
        [286.235, 269.916, 280.166],
        [286.059, 269.759, 280.236],
        [285.888, 269.604, 280.307],
        [285.723, 269.453, 280.378],
        [285.566, 269.308, 280.447],
        [285.418, 269.170, 280.513],
        [285.281, 269.041, 280.573],
        [285.157, 268.924, 280.627],
        [285.047, 268.819, 280.673],
        [284.953, 268.728, 280.709],
        [284.875, 268.653, 280.735],
        [284.812, 268.591, 280.751],
        [284.763, 268.543, 280.760],
        [284.727, 268.505, 280.761],
        [284.702, 268.478, 280.755],
        [284.688, 268.459, 280.745],
        [284.683, 268.448, 280.730],
        [284.685, 268.443, 280.712],
        [284.694, 268.444, 280.692],
        [284.709, 268.447, 280.671],
        [284.727, 268.454, 280.650],
        [284.749, 268.461, 280.629],
        [284.772, 268.468, 280.611],
        [284.796, 268.473, 280.596],
        [284.819, 268.476, 280.585],
        [284.840, 268.475, 280.579],
        [284.859, 268.470, 280.576],
        [284.875, 268.462, 280.577],
        [284.888, 268.451, 280.581],
        [284.898, 268.438, 280.586],
        [284.904, 268.421, 280.593],
        [284.906, 268.403, 280.599],
        [284.903, 268.383, 280.605],
        [284.896, 268.362, 280.609],
        [284.883, 268.340, 280.611],
        [284.864, 268.316, 280.610],
        [284.840, 268.293, 280.605],
        [284.809, 268.269, 280.595],
        [284.772, 268.245, 280.580],
        [284.727, 268.222, 280.558],
        [284.675, 268.199, 280.530],
        [284.615, 268.177, 280.495],
        [284.548, 268.156, 280.455],
        [284.474, 268.135, 280.410],
        [284.393, 268.114, 280.362],
        [284.304, 268.092, 280.312],
        [284.208, 268.071, 280.260],
        [284.106, 268.049, 280.208],
        [283.996, 268.026, 280.156],
        [283.880, 268.003, 280.106],
        [283.757, 267.978, 280.059],
        [283.627, 267.952, 280.015],
        [283.491, 267.924, 279.976],
        [283.348, 267.895, 279.943],
        [283.199, 267.864, 279.916],
        [283.044, 267.831, 279.897],
        [282.883, 267.796, 279.885],
        [282.718, 267.760, 279.881],
        [282.550, 267.724, 279.883],
        [282.380, 267.689, 279.891],
        [282.210, 267.655, 279.905],
        [282.041, 267.623, 279.923],
        [281.874, 267.595, 279.945],
        [281.711, 267.569, 279.971],
        [281.552, 267.548, 280.000],
        [281.399, 267.533, 280.032],
        [281.254, 267.523, 280.065],
        [281.117, 267.520, 280.100],
        [280.989, 267.525, 280.135],
        [280.873, 267.538, 280.170],
        [280.769, 267.560, 280.204],
        [280.678, 267.591, 280.238],
        [280.598, 267.630, 280.270],
        [280.529, 267.675, 280.300],
        [280.468, 267.726, 280.328],
        [280.415, 267.780, 280.353],
        [280.367, 267.837, 280.375],
        [280.325, 267.896, 280.393],
        [280.286, 267.955, 280.407],
        [280.250, 268.012, 280.417],
        [280.214, 268.067, 280.422],
        [280.178, 268.119, 280.421],
        [280.140, 268.165, 280.415],
        [280.099, 268.205, 280.403],
        [280.054, 268.238, 280.384],
        [280.003, 268.262, 280.358],
        [279.945, 268.276, 280.325],
        [279.881, 268.281, 280.285],
        [279.809, 268.278, 280.240],
        [279.730, 268.267, 280.189],
        [279.644, 268.251, 280.135],
        [279.550, 268.230, 280.078],
        [279.450, 268.204, 280.018],
        [279.341, 268.175, 279.957],
        [279.225, 268.143, 279.895],
        [279.102, 268.110, 279.833],
        [278.970, 268.077, 279.772],
        [278.831, 268.044, 279.712],
        [278.684, 268.012, 279.656],
        [278.528, 267.983, 279.602],
        [278.365, 267.957, 279.553],
        [278.194, 267.935, 279.509],
        [278.015, 267.917, 279.470],
        [277.833, 267.902, 279.435],
        [277.647, 267.891, 279.404],
        [277.461, 267.883, 279.377],
        [277.276, 267.877, 279.353],
        [277.094, 267.874, 279.332],
        [276.916, 267.872, 279.314],
        [276.746, 267.872, 279.298],
        [276.584, 267.872, 279.284],
        [276.433, 267.874, 279.271],
        [276.295, 267.875, 279.259],
        [276.171, 267.876, 279.248],
        [276.064, 267.877, 279.238],
        [275.975, 267.877, 279.227],
        [275.906, 267.876, 279.216],
        [275.857, 267.874, 279.204],
        [275.824, 267.870, 279.193],
        [275.805, 267.865, 279.182],
        [275.798, 267.859, 279.171],
        [275.799, 267.852, 279.162],
        [275.806, 267.844, 279.155],
        [275.817, 267.836, 279.149],
        [275.827, 267.827, 279.146],
        [275.836, 267.817, 279.145],
        [275.839, 267.808, 279.148],
        [275.835, 267.797, 279.154],
        [275.820, 267.787, 279.164],
        [275.792, 267.776, 279.178],
        [275.748, 267.765, 279.196],
        [275.686, 267.755, 279.220],
        [275.604, 267.745, 279.249],
        [275.506, 267.735, 279.281],
        [275.394, 267.725, 279.318],
        [275.269, 267.717, 279.357],
        [275.136, 267.709, 279.398],
        [274.996, 267.703, 279.440],
        [274.852, 267.698, 279.483],
        [274.707, 267.694, 279.525],
        [274.562, 267.692, 279.567],
        [274.421, 267.692, 279.606],
        [274.287, 267.694, 279.644],
        [274.161, 267.698, 279.678],
        [274.047, 267.705, 279.708],
        [273.946, 267.714, 279.733],
        [273.862, 267.726, 279.753],
        [273.795, 267.741, 279.767],
        [273.745, 267.758, 279.776],
        [273.708, 267.775, 279.781],
        [273.683, 267.792, 279.783],
        [273.667, 267.807, 279.783],
        [273.657, 267.820, 279.782],
        [273.651, 267.829, 279.781],
        [273.647, 267.833, 279.781],
        [273.642, 267.832, 279.783],
        [273.634, 267.823, 279.788],
        [273.621, 267.807, 279.797],
        [273.600, 267.782, 279.811],
        [273.569, 267.746, 279.831],
        [273.526, 267.700, 279.859],
        [273.468, 267.641, 279.894],
        [273.392, 267.569, 279.938],
        [273.302, 267.484, 279.990],
        [273.197, 267.390, 280.050],
        [273.082, 267.287, 280.115],
        [272.957, 267.178, 280.185],
        [272.825, 267.063, 280.259],
        [272.689, 266.945, 280.336],
        [272.551, 266.826, 280.413],
        [272.412, 266.706, 280.491],
        [272.274, 266.589, 280.568],
        [272.141, 266.476, 280.643],
        [272.015, 266.368, 280.715],
        [271.897, 266.267, 280.783],
        [271.789, 266.175, 280.845],
        [271.694, 266.093, 280.900],
        [271.615, 266.024, 280.948],
        [271.550, 265.968, 280.988],
        [271.500, 265.923, 281.021],
        [271.461, 265.889, 281.047],
        [271.435, 265.864, 281.067],
        [271.418, 265.848, 281.081],
        [271.409, 265.839, 281.090],
        [271.409, 265.838, 281.095],
        [271.414, 265.842, 281.096],
        [271.424, 265.850, 281.094],
        [271.438, 265.863, 281.088],
        [271.454, 265.878, 281.081],
        [271.471, 265.896, 281.072],
        [271.487, 265.914, 281.061],
        [271.502, 265.933, 281.051],
        [271.514, 265.950, 281.040],
        [271.523, 265.966, 281.029],
        [271.529, 265.980, 281.020],
        [271.531, 265.992, 281.011],
        [271.532, 266.001, 281.004],
        [271.530, 266.009, 280.998],
        [271.526, 266.014, 280.993],
        [271.522, 266.017, 280.991],
        [271.516, 266.016, 280.991],
        [271.510, 266.013, 280.994],
        [271.504, 266.007, 280.999],
        [271.498, 265.997, 281.007],
        [271.493, 265.984, 281.019],
        [271.489, 265.967, 281.035],
        [271.486, 265.947, 281.054],
        [271.485, 265.922, 281.077],
        [271.486, 265.894, 281.104],
        [271.487, 265.861, 281.136],
        [271.489, 265.825, 281.171],
        [271.490, 265.786, 281.209],
        [271.488, 265.743, 281.250],
        [271.483, 265.698, 281.294],
        [271.473, 265.649, 281.339],
        [271.459, 265.598, 281.387],
        [271.437, 265.544, 281.436],
        [271.409, 265.488, 281.486],
        [271.372, 265.429, 281.537],
        [271.325, 265.369, 281.589],
        [271.268, 265.308, 281.641],
        [271.199, 265.244, 281.692],
        [271.117, 265.180, 281.743],
        [271.022, 265.114, 281.792],
        [270.914, 265.047, 281.841],
        [270.796, 264.980, 281.889],
        [270.669, 264.914, 281.935],
        [270.534, 264.847, 281.980],
        [270.394, 264.782, 282.024],
        [270.251, 264.718, 282.066],
        [270.105, 264.656, 282.107],
        [269.958, 264.596, 282.146],
        [269.813, 264.538, 282.183],
        [269.671, 264.483, 282.218],
        [269.534, 264.432, 282.252],
        [269.403, 264.385, 282.284],
        [269.280, 264.341, 282.313],
        [269.167, 264.303, 282.341],
        [269.066, 264.269, 282.366],
        [268.976, 264.240, 282.389],
        [268.896, 264.214, 282.411],
        [268.824, 264.191, 282.431],
        [268.760, 264.170, 282.449],
        [268.702, 264.150, 282.466],
        [268.649, 264.129, 282.483],
        [268.599, 264.108, 282.499],
        [268.551, 264.084, 282.514],
        [268.504, 264.058, 282.529],
        [268.457, 264.027, 282.544],
        [268.408, 263.992, 282.560],
        [268.355, 263.951, 282.576],
        [268.298, 263.904, 282.592],
        [268.235, 263.848, 282.610],
        [268.165, 263.785, 282.629],
        [268.088, 263.712, 282.649],
        [268.004, 263.633, 282.670],
        [267.915, 263.548, 282.692],
        [267.822, 263.459, 282.714],
        [267.726, 263.367, 282.736],
        [267.628, 263.274, 282.759],
        [267.530, 263.181, 282.780],
        [267.431, 263.090, 282.801],
        [267.335, 263.003, 282.821],
        [267.240, 262.920, 282.839],
        [267.150, 262.843, 282.856],
        [267.064, 262.773, 282.871],
        [266.985, 262.713, 282.883],
        [266.912, 262.664, 282.893],
        [266.848, 262.627, 282.900],
        [266.792, 262.602, 282.904],
        [266.743, 262.589, 282.905],
        [266.699, 262.585, 282.902],
        [266.658, 262.590, 282.896],
        [266.618, 262.602, 282.886],
        [266.576, 262.618, 282.872],
        [266.531, 262.638, 282.853],
        [266.482, 262.659, 282.830],
        [266.424, 262.680, 282.802],
        [266.358, 262.700, 282.770],
        [266.280, 262.716, 282.732],
        [266.189, 262.728, 282.689],
        [266.083, 262.733, 282.641],
        [265.960, 262.730, 282.587],
        [265.817, 262.718, 282.528],
        [265.654, 262.694, 282.462],
        [265.471, 262.659, 282.392],
        [265.272, 262.615, 282.317],
        [265.060, 262.561, 282.240],
        [264.836, 262.500, 282.161],
        [264.605, 262.430, 282.082],
        [264.368, 262.355, 282.003],
        [264.128, 262.273, 281.926],
        [263.889, 262.187, 281.852],
        [263.652, 262.097, 281.782],
        [263.420, 262.004, 281.717],
        [263.197, 261.909, 281.658],
        [262.985, 261.812, 281.606],
        [262.786, 261.714, 281.563],
        [262.604, 261.617, 281.530],
        [262.441, 261.521, 281.507],
        [262.296, 261.427, 281.495],
        [262.165, 261.338, 281.494],
        [262.046, 261.254, 281.502],
        [261.935, 261.177, 281.519],
        [261.830, 261.108, 281.546],
        [261.726, 261.050, 281.580],
        [261.622, 261.003, 281.622],
        [261.513, 260.969, 281.672],
        [261.396, 260.950, 281.729],
        [261.269, 260.947, 281.792],
        [261.127, 260.962, 281.860],
        [260.969, 260.997, 281.934],
        [260.790, 261.052, 282.013],
        [260.587, 261.129, 282.096],
        [260.358, 261.230, 282.183],
        [260.102, 261.355, 282.273],
        [259.823, 261.500, 282.365],
        [259.523, 261.663, 282.458],
        [259.208, 261.841, 282.552],
        [258.881, 262.030, 282.645],
        [258.546, 262.228, 282.736],
        [258.205, 262.432, 282.825],
        [257.864, 262.639, 282.910],
        [257.526, 262.846, 282.990],
        [257.194, 263.050, 283.065],
        [256.872, 263.248, 283.133],
        [256.564, 263.437, 283.194],
        [256.274, 263.614, 283.246],
        [256.005, 263.776, 283.289],
        [255.762, 263.921, 283.321],
        [255.546, 264.046, 283.343],
        [255.356, 264.153, 283.355],
        [255.192, 264.242, 283.358],
        [255.051, 264.317, 283.353],
        [254.932, 264.378, 283.341],
        [254.834, 264.427, 283.323],
        [254.754, 264.466, 283.301],
        [254.693, 264.495, 283.276],
        [254.647, 264.517, 283.248],
        [254.615, 264.534, 283.218],
        [254.597, 264.546, 283.188],
        [254.590, 264.556, 283.159],
        [254.592, 264.565, 283.131],
        [254.604, 264.574, 283.106],
        [254.622, 264.585, 283.085],
        [254.646, 264.600, 283.069],
        [254.673, 264.618, 283.058],
        [254.703, 264.637, 283.050],
        [254.732, 264.656, 283.046],
        [254.761, 264.675, 283.045],
        [254.786, 264.693, 283.047],
        [254.807, 264.707, 283.051],
        [254.822, 264.717, 283.056],
        [254.828, 264.722, 283.063],
        [254.825, 264.721, 283.070],
        [254.810, 264.712, 283.077],
        [254.782, 264.695, 283.084],
        [254.740, 264.668, 283.090],
        [254.681, 264.630, 283.095],
        [254.604, 264.580, 283.098],
        [254.507, 264.516, 283.098],
        [254.392, 264.441, 283.097],
        [254.260, 264.355, 283.093],
        [254.115, 264.260, 283.088],
        [253.958, 264.158, 283.083],
        [253.793, 264.051, 283.077],
        [253.621, 263.941, 283.070],
        [253.446, 263.829, 283.065],
        [253.269, 263.718, 283.060],
        [253.093, 263.609, 283.057],
        [252.921, 263.504, 283.055],
        [252.755, 263.405, 283.056],
        [252.598, 263.314, 283.060],
        [252.452, 263.232, 283.067],
        [252.319, 263.161, 283.077],
        [252.203, 263.103, 283.091],
        [252.103, 263.059, 283.109],
        [252.021, 263.027, 283.130],
        [251.954, 263.005, 283.153],
        [251.903, 262.993, 283.175],
        [251.868, 262.989, 283.197],
        [251.847, 262.991, 283.216],
        [251.840, 262.998, 283.233],
        [251.846, 263.008, 283.245],
        [251.865, 263.020, 283.251],
        [251.897, 263.034, 283.251],
        [251.941, 263.046, 283.242],
        [251.996, 263.056, 283.225],
        [252.063, 263.063, 283.197],
        [252.139, 263.064, 283.157],
        [252.225, 263.059, 283.105],
        [252.319, 263.047, 283.041],
        [252.416, 263.029, 282.967],
        [252.510, 263.009, 282.888],
        [252.595, 262.987, 282.808],
        [252.666, 262.965, 282.730],
        [252.717, 262.946, 282.658],
        [252.742, 262.932, 282.596],
        [252.737, 262.925, 282.549],
        [252.694, 262.927, 282.519],
        [252.609, 262.939, 282.510],
        [252.476, 262.964, 282.527],
        [252.289, 263.003, 282.573],
        [252.042, 263.059, 282.653],
        [251.731, 263.135, 282.769],
        [251.348, 263.230, 282.926],
        [250.892, 263.348, 283.127],
        [250.369, 263.486, 283.368],
        [249.789, 263.641, 283.646],
        [249.163, 263.811, 283.956],
        [248.503, 263.993, 284.293],
        [247.818, 264.183, 284.653],
        [247.118, 264.378, 285.033],
        [246.415, 264.577, 285.426],
        [245.720, 264.776, 285.830],
        [245.041, 264.971, 286.239],
        [244.391, 265.162, 286.650],
        [243.780, 265.343, 287.057],
        [243.218, 265.513, 287.457],
        [242.716, 265.669, 287.845],
        [242.284, 265.807, 288.216],
        [241.932, 265.926, 288.567],
        [241.659, 266.025, 288.896],
        [241.459, 266.105, 289.204],
        [241.325, 266.168, 289.492],
        [241.249, 266.216, 289.758],
        [241.224, 266.250, 290.005],
        [241.244, 266.272, 290.233],
        [241.302, 266.283, 290.442],
        [241.390, 266.284, 290.633],
        [241.501, 266.278, 290.805],
        [241.629, 266.266, 290.961],
        [241.767, 266.249, 291.099],
        [241.908, 266.228, 291.221],
        [242.044, 266.207, 291.328],
        [242.168, 266.185, 291.418],
        [242.275, 266.164, 291.494],
        [242.360, 266.145, 291.556],
        [242.425, 266.129, 291.605],
        [242.472, 266.115, 291.642],
        [242.502, 266.102, 291.668],
        [242.517, 266.092, 291.684],
        [242.518, 266.083, 291.692],
        [242.507, 266.076, 291.692],
        [242.486, 266.070, 291.686],
        [242.456, 266.066, 291.674],
        [242.419, 266.063, 291.658],
        [242.376, 266.062, 291.638],
        [242.328, 266.061, 291.617],
        [242.279, 266.062, 291.594],
        [242.228, 266.064, 291.571],
        [242.179, 266.066, 291.550],
        [242.131, 266.069, 291.531],
        [242.084, 266.072, 291.516],
        [242.040, 266.071, 291.506],
        [241.998, 266.068, 291.503],
        [241.958, 266.059, 291.508],
        [241.920, 266.043, 291.523],
        [241.884, 266.019, 291.550],
        [241.850, 265.986, 291.589],
        [241.818, 265.942, 291.643],
        [241.788, 265.886, 291.712],
        [241.760, 265.816, 291.799],
        [241.735, 265.731, 291.905],
        [241.711, 265.630, 292.031],
        [241.690, 265.510, 292.179],
        [241.670, 265.372, 292.351],
        [241.653, 265.212, 292.547],
        [241.637, 265.035, 292.765],
        [241.624, 264.841, 293.003],
        [241.611, 264.633, 293.257],
        [241.600, 264.415, 293.526],
        [241.589, 264.188, 293.806],
        [241.580, 263.954, 294.094],
        [241.570, 263.717, 294.388],
        [241.560, 263.478, 294.685],
        [241.550, 263.241, 294.982],
        [241.540, 263.007, 295.276],
        [241.529, 262.779, 295.566],
        [241.517, 262.560, 295.846],
        [241.503, 262.352, 296.116],
        [241.488, 262.158, 296.373],
        [241.472, 261.979, 296.613],
        [241.453, 261.816, 296.836],
        [241.433, 261.669, 297.042],
        [241.412, 261.537, 297.233],
        [241.391, 261.418, 297.408],
        [241.368, 261.313, 297.569],
        [241.345, 261.220, 297.715],
        [241.323, 261.139, 297.847],
        [241.300, 261.070, 297.966],
        [241.279, 261.010, 298.072],
        [241.258, 260.961, 298.166],
        [241.238, 260.920, 298.248],
        [241.220, 260.888, 298.320],
        [241.203, 260.863, 298.380],
        [241.189, 260.844, 298.430],
        [241.177, 260.832, 298.471],
        [241.167, 260.825, 298.503],
        [241.159, 260.823, 298.526],
        [241.153, 260.824, 298.544],
        [241.148, 260.828, 298.555],
        [241.145, 260.834, 298.562],
        [241.142, 260.842, 298.565],
        [241.140, 260.849, 298.565],
        [241.138, 260.856, 298.564],
        [241.136, 260.862, 298.563],
        [241.134, 260.866, 298.562],
        [241.131, 260.867, 298.562],
        [241.127, 260.864, 298.566],
        [241.122, 260.856, 298.573],
        [241.115, 260.843, 298.584],
        [241.107, 260.824, 298.602],
        [241.096, 260.799, 298.626],
        [241.084, 260.767, 298.656],
        [241.069, 260.731, 298.692],
        [241.052, 260.691, 298.734],
        [241.033, 260.649, 298.781],
        [241.012, 260.604, 298.834],
        [240.989, 260.558, 298.891],
        [240.964, 260.513, 298.953],
        [240.937, 260.468, 299.020],
        [240.907, 260.425, 299.090],
        [240.875, 260.386, 299.165],
        [240.841, 260.349, 299.243],
        [240.805, 260.318, 299.324],
        [240.767, 260.293, 299.408],
        [240.726, 260.274, 299.495],
        [240.683, 260.262, 299.584],
        [240.637, 260.257, 299.676],
        [240.588, 260.259, 299.770],
        [240.536, 260.266, 299.865],
        [240.480, 260.279, 299.963],
        [240.420, 260.296, 300.061],
        [240.355, 260.316, 300.162],
        [240.284, 260.340, 300.263],
        [240.208, 260.366, 300.365],
        [240.127, 260.394, 300.468],
        [240.039, 260.423, 300.572],
        [239.944, 260.453, 300.676],
        [239.842, 260.482, 300.780],
        [239.732, 260.511, 300.884],
        [239.614, 260.538, 300.988],
        [239.488, 260.563, 301.092],
        [239.355, 260.585, 301.196],
        [239.216, 260.605, 301.300],
        [239.072, 260.622, 301.406],
        [238.926, 260.636, 301.514],
        [238.778, 260.646, 301.625],
        [238.631, 260.652, 301.738],
        [238.485, 260.655, 301.856],
        [238.343, 260.654, 301.978],
        [238.206, 260.648, 302.105],
        [238.075, 260.637, 302.238],
        [237.953, 260.622, 302.377],
        [237.839, 260.602, 302.524],
        [237.737, 260.576, 302.678],
        [237.648, 260.545, 302.841],
        [237.573, 260.508, 303.012],
        [237.512, 260.465, 303.192],
        [237.464, 260.417, 303.378],
        [237.429, 260.364, 303.569],
        [237.403, 260.308, 303.762],
        [237.388, 260.247, 303.956],
        [237.380, 260.183, 304.148],
        [237.379, 260.116, 304.337],
        [237.384, 260.047, 304.521],
        [237.393, 259.976, 304.697],
        [237.405, 259.904, 304.865],
        [237.419, 259.831, 305.021],
        [237.433, 259.757, 305.164],
        [237.447, 259.683, 305.292],
        [237.459, 259.611, 305.403],
        [237.467, 259.539, 305.495],
        [237.471, 259.468, 305.568],
        [237.471, 259.398, 305.623],
        [237.465, 259.329, 305.663],
        [237.455, 259.261, 305.691],
        [237.438, 259.192, 305.709],
        [237.416, 259.123, 305.719],
        [237.387, 259.053, 305.723],
        [237.352, 258.982, 305.725],
        [237.310, 258.910, 305.727],
        [237.260, 258.835, 305.731],
        [237.203, 258.759, 305.740],
        [237.138, 258.680, 305.756],
        [237.064, 258.599, 305.781],
        [236.982, 258.514, 305.818],
        [236.891, 258.426, 305.870],
        [236.791, 258.334, 305.937],
        [236.682, 258.239, 306.020],
        [236.566, 258.142, 306.116],
        [236.443, 258.043, 306.223],
        [236.314, 257.944, 306.339],
        [236.180, 257.845, 306.462],
        [236.041, 257.748, 306.590],
        [235.900, 257.652, 306.722],
        [235.755, 257.559, 306.855],
        [235.609, 257.470, 306.987],
        [235.463, 257.385, 307.116],
        [235.316, 257.305, 307.241],
        [235.170, 257.231, 307.360],
        [235.026, 257.165, 307.469],
        [234.884, 257.106, 307.569],
        [234.746, 257.055, 307.656],
        [234.612, 257.012, 307.731],
        [234.482, 256.974, 307.796],
        [234.356, 256.939, 307.851],
        [234.235, 256.906, 307.899],
        [234.120, 256.871, 307.941],
        [234.009, 256.833, 307.978],
        [233.904, 256.790, 308.012],
        [233.805, 256.740, 308.044],
        [233.712, 256.681, 308.076],
        [233.626, 256.610, 308.108],
        [233.546, 256.526, 308.144],
        [233.473, 256.427, 308.183],
        [233.408, 256.310, 308.227],
        [233.350, 256.174, 308.278],
        [233.301, 256.016, 308.337],
        [233.259, 255.837, 308.405],
        [233.223, 255.639, 308.480],
        [233.194, 255.426, 308.562],
        [233.171, 255.200, 308.650],
        [233.151, 254.964, 308.743],
        [233.136, 254.721, 308.841],
        [233.124, 254.473, 308.941],
        [233.114, 254.225, 309.044],
        [233.106, 253.977, 309.148],
        [233.098, 253.734, 309.252],
        [233.091, 253.498, 309.357],
        [233.082, 253.271, 309.460],
        [233.073, 253.057, 309.562],
        [233.060, 252.859, 309.660],
        [233.045, 252.679, 309.755],
        [233.026, 252.519, 309.845],
        [233.004, 252.378, 309.931],
        [232.979, 252.255, 310.013],
        [232.951, 252.147, 310.092],
        [232.920, 252.054, 310.168],
        [232.887, 251.975, 310.241],
        [232.852, 251.908, 310.311],
        [232.814, 251.851, 310.379],
        [232.776, 251.804, 310.445],
        [232.735, 251.765, 310.509],
        [232.694, 251.733, 310.571],
        [232.651, 251.706, 310.633],
        [232.608, 251.683, 310.693],
        [232.564, 251.663, 310.753],
        [232.520, 251.644, 310.813],
    ],
    "6Z6K": [
        [212.005, 238.667, 231.029],
        [211.985, 238.592, 230.942],
        [211.966, 238.517, 230.854],
        [211.946, 238.445, 230.766],
        [211.926, 238.375, 230.678],
        [211.905, 238.309, 230.589],
        [211.883, 238.246, 230.499],
        [211.860, 238.189, 230.409],
        [211.836, 238.138, 230.317],
        [211.810, 238.094, 230.224],
        [211.783, 238.057, 230.130],
        [211.755, 238.029, 230.034],
        [211.724, 238.010, 229.936],
        [211.692, 238.000, 229.836],
        [211.658, 237.999, 229.735],
        [211.622, 238.005, 229.632],
        [211.585, 238.018, 229.528],
        [211.547, 238.038, 229.421],
        [211.507, 238.063, 229.314],
        [211.466, 238.092, 229.204],
        [211.424, 238.126, 229.093],
        [211.381, 238.163, 228.981],
        [211.337, 238.203, 228.867],
        [211.292, 238.245, 228.751],
        [211.247, 238.288, 228.635],
        [211.201, 238.332, 228.518],
        [211.156, 238.377, 228.401],
        [211.111, 238.422, 228.285],
        [211.066, 238.466, 228.171],
        [211.023, 238.509, 228.060],
        [210.981, 238.551, 227.951],
        [210.940, 238.590, 227.846],
        [210.901, 238.628, 227.746],
        [210.864, 238.663, 227.650],
        [210.829, 238.694, 227.561],
        [210.797, 238.722, 227.478],
        [210.767, 238.749, 227.400],
        [210.739, 238.775, 227.329],
        [210.713, 238.802, 227.263],
        [210.689, 238.831, 227.203],
        [210.666, 238.865, 227.148],
        [210.643, 238.904, 227.097],
        [210.622, 238.950, 227.051],
        [210.600, 239.004, 227.010],
        [210.579, 239.068, 226.972],
        [210.558, 239.144, 226.938],
        [210.536, 239.232, 226.908],
        [210.514, 239.330, 226.881],
        [210.492, 239.435, 226.857],
        [210.471, 239.546, 226.836],
        [210.450, 239.658, 226.817],
        [210.430, 239.770, 226.802],
        [210.411, 239.878, 226.788],
        [210.393, 239.979, 226.777],
        [210.377, 240.072, 226.768],
        [210.363, 240.152, 226.760],
        [210.351, 240.218, 226.754],
        [210.341, 240.267, 226.750],
        [210.334, 240.299, 226.747],
        [210.329, 240.318, 226.744],
        [210.325, 240.327, 226.743],
        [210.323, 240.328, 226.743],
        [210.322, 240.326, 226.743],
        [210.323, 240.323, 226.745],
        [210.324, 240.322, 226.746],
        [210.325, 240.326, 226.749],
        [210.326, 240.338, 226.752],
        [210.328, 240.362, 226.755],
        [210.329, 240.401, 226.758],
        [210.329, 240.455, 226.761],
        [210.326, 240.524, 226.764],
        [210.320, 240.605, 226.766],
        [210.308, 240.697, 226.768],
        [210.290, 240.798, 226.769],
        [210.265, 240.907, 226.768],
        [210.230, 241.021, 226.765],
        [210.184, 241.140, 226.761],
        [210.127, 241.262, 226.755],
        [210.057, 241.384, 226.746],
        [209.972, 241.505, 226.735],
        [209.872, 241.625, 226.721],
        [209.760, 241.742, 226.704],
        [209.640, 241.856, 226.686],
        [209.515, 241.967, 226.666],
        [209.388, 242.076, 226.645],
        [209.263, 242.181, 226.623],
        [209.143, 242.283, 226.601],
        [209.032, 242.382, 226.579],
        [208.933, 242.477, 226.558],
        [208.850, 242.568, 226.538],
        [208.785, 242.655, 226.520],
        [208.742, 242.738, 226.504],
        [208.720, 242.816, 226.489],
        [208.715, 242.889, 226.476],
        [208.726, 242.954, 226.463],
        [208.749, 243.013, 226.451],
        [208.782, 243.062, 226.439],
        [208.822, 243.103, 226.426],
        [208.867, 243.134, 226.413],
        [208.912, 243.154, 226.398],
        [208.957, 243.162, 226.382],
        [208.998, 243.157, 226.363],
        [209.033, 243.139, 226.342],
        [209.060, 243.110, 226.319],
        [209.080, 243.075, 226.296],
        [209.093, 243.038, 226.273],
        [209.100, 243.005, 226.253],
        [209.102, 242.980, 226.237],
        [209.098, 242.967, 226.225],
        [209.089, 242.972, 226.220],
        [209.075, 242.999, 226.224],
        [209.057, 243.054, 226.237],
        [209.035, 243.140, 226.260],
        [209.010, 243.263, 226.296],
        [208.982, 243.424, 226.344],
        [208.952, 243.615, 226.400],
        [208.920, 243.832, 226.462],
        [208.887, 244.068, 226.525],
        [208.853, 244.316, 226.586],
        [208.820, 244.570, 226.642],
        [208.786, 244.823, 226.689],
        [208.755, 245.069, 226.724],
        [208.725, 245.301, 226.742],
        [208.697, 245.514, 226.742],
        [208.672, 245.700, 226.718],
        [208.651, 245.855, 226.669],
        [208.631, 245.984, 226.595],
        [208.611, 246.090, 226.500],
        [208.588, 246.179, 226.385],
        [208.562, 246.256, 226.252],
        [208.529, 246.326, 226.104],
        [208.488, 246.395, 225.942],
        [208.438, 246.466, 225.769],
        [208.376, 246.546, 225.587],
        [208.300, 246.640, 225.398],
        [208.209, 246.752, 225.204],
        [208.100, 246.888, 225.008],
        [207.975, 247.046, 224.810],
        [207.836, 247.223, 224.612],
        [207.683, 247.416, 224.415],
        [207.518, 247.623, 224.220],
        [207.344, 247.839, 224.029],
        [207.162, 248.062, 223.842],
        [206.974, 248.289, 223.661],
        [206.781, 248.516, 223.487],
        [206.585, 248.740, 223.321],
        [206.388, 248.958, 223.164],
        [206.192, 249.168, 223.017],
        [205.998, 249.366, 222.881],
        [205.809, 249.554, 222.756],
        [205.625, 249.731, 222.641],
        [205.449, 249.896, 222.536],
        [205.282, 250.050, 222.440],
        [205.127, 250.193, 222.354],
        [204.985, 250.323, 222.276],
        [204.858, 250.441, 222.207],
        [204.747, 250.547, 222.147],
        [204.655, 250.641, 222.094],
        [204.583, 250.721, 222.050],
        [204.531, 250.790, 222.012],
        [204.499, 250.849, 221.982],
        [204.483, 250.899, 221.957],
        [204.481, 250.943, 221.939],
        [204.491, 250.984, 221.925],
        [204.511, 251.023, 221.916],
        [204.538, 251.063, 221.911],
        [204.571, 251.105, 221.910],
        [204.606, 251.152, 221.911],
        [204.642, 251.205, 221.915],
        [204.676, 251.268, 221.920],
        [204.707, 251.342, 221.927],
        [204.733, 251.424, 221.934],
        [204.755, 251.514, 221.942],
        [204.773, 251.608, 221.949],
        [204.787, 251.706, 221.955],
        [204.796, 251.805, 221.959],
        [204.800, 251.902, 221.962],
        [204.800, 251.996, 221.961],
        [204.795, 252.084, 221.957],
        [204.785, 252.165, 221.950],
        [204.771, 252.237, 221.938],
        [204.751, 252.297, 221.921],
        [204.728, 252.345, 221.900],
        [204.700, 252.382, 221.874],
        [204.671, 252.408, 221.846],
        [204.640, 252.426, 221.815],
        [204.609, 252.434, 221.782],
        [204.578, 252.434, 221.748],
        [204.549, 252.428, 221.715],
        [204.522, 252.414, 221.681],
        [204.499, 252.395, 221.649],
        [204.481, 252.372, 221.619],
        [204.468, 252.343, 221.592],
        [204.460, 252.313, 221.568],
        [204.457, 252.282, 221.547],
        [204.456, 252.253, 221.529],
        [204.456, 252.230, 221.514],
        [204.457, 252.213, 221.501],
        [204.456, 252.207, 221.492],
        [204.452, 252.212, 221.485],
        [204.445, 252.233, 221.481],
        [204.431, 252.271, 221.480],
        [204.411, 252.329, 221.481],
        [204.382, 252.408, 221.485],
        [204.344, 252.512, 221.491],
        [204.299, 252.635, 221.498],
        [204.247, 252.774, 221.507],
        [204.190, 252.927, 221.516],
        [204.129, 253.088, 221.525],
        [204.066, 253.254, 221.533],
        [204.002, 253.422, 221.539],
        [203.939, 253.587, 221.544],
        [203.877, 253.746, 221.545],
        [203.819, 253.895, 221.543],
        [203.766, 254.031, 221.537],
        [203.719, 254.150, 221.526],
        [203.677, 254.251, 221.510],
        [203.641, 254.337, 221.491],
        [203.610, 254.408, 221.469],
        [203.584, 254.464, 221.443],
        [203.563, 254.506, 221.416],
        [203.545, 254.536, 221.387],
        [203.530, 254.555, 221.356],
        [203.519, 254.562, 221.325],
        [203.510, 254.560, 221.294],
        [203.504, 254.548, 221.263],
        [203.499, 254.528, 221.233],
        [203.495, 254.503, 221.204],
        [203.491, 254.477, 221.178],
        [203.486, 254.455, 221.154],
        [203.477, 254.440, 221.133],
        [203.466, 254.437, 221.117],
        [203.449, 254.451, 221.104],
        [203.426, 254.485, 221.097],
        [203.396, 254.544, 221.096],
        [203.357, 254.632, 221.101],
        [203.309, 254.754, 221.112],
        [203.250, 254.913, 221.132],
        [203.180, 255.110, 221.158],
        [203.103, 255.338, 221.190],
        [203.019, 255.588, 221.227],
        [202.932, 255.853, 221.267],
        [202.844, 256.126, 221.309],
        [202.758, 256.399, 221.351],
        [202.676, 256.665, 221.392],
        [202.600, 256.915, 221.430],
        [202.534, 257.142, 221.464],
        [202.478, 257.339, 221.493],
        [202.437, 257.498, 221.515],
        [202.411, 257.614, 221.529],
        [202.398, 257.692, 221.537],
        [202.394, 257.737, 221.539],
        [202.398, 257.756, 221.538],
        [202.405, 257.755, 221.535],
        [202.412, 257.740, 221.530],
        [202.418, 257.717, 221.527],
        [202.417, 257.692, 221.525],
        [202.408, 257.672, 221.527],
        [202.387, 257.662, 221.534],
        [202.351, 257.669, 221.547],
        [202.298, 257.697, 221.569],
        [202.229, 257.747, 221.597],
        [202.146, 257.816, 221.630],
        [202.053, 257.900, 221.667],
        [201.951, 257.996, 221.705],
        [201.844, 258.101, 221.745],
        [201.734, 258.213, 221.783],
        [201.625, 258.328, 221.818],
        [201.518, 258.443, 221.848],
        [201.417, 258.556, 221.873],
        [201.324, 258.662, 221.889],
        [201.242, 258.760, 221.897],
        [201.171, 258.848, 221.895],
        [201.111, 258.928, 221.885],
        [201.060, 259.000, 221.869],
        [201.016, 259.066, 221.848],
        [200.978, 259.128, 221.824],
        [200.946, 259.185, 221.798],
        [200.917, 259.241, 221.772],
        [200.891, 259.294, 221.747],
        [200.866, 259.348, 221.724],
        [200.841, 259.402, 221.706],
        [200.814, 259.459, 221.694],
        [200.785, 259.519, 221.688],
        [200.752, 259.585, 221.689],
        [200.714, 259.657, 221.696],
        [200.670, 259.738, 221.709],
        [200.618, 259.828, 221.727],
        [200.559, 259.931, 221.751],
        [200.490, 260.047, 221.780],
        [200.410, 260.178, 221.814],
        [200.319, 260.325, 221.852],
        [200.215, 260.491, 221.895],
        [200.098, 260.677, 221.941],
        [199.966, 260.884, 221.991],
        [199.822, 261.107, 222.044],
        [199.670, 261.343, 222.098],
        [199.513, 261.587, 222.151],
        [199.354, 261.833, 222.204],
        [199.197, 262.077, 222.254],
        [199.044, 262.315, 222.300],
        [198.899, 262.542, 222.341],
        [198.765, 262.753, 222.376],
        [198.646, 262.943, 222.403],
        [198.545, 263.108, 222.421],
        [198.464, 263.244, 222.430],
        [198.404, 263.351, 222.429],
        [198.361, 263.432, 222.420],
        [198.333, 263.492, 222.404],
        [198.318, 263.534, 222.382],
        [198.314, 263.561, 222.357],
        [198.316, 263.576, 222.328],
        [198.324, 263.584, 222.298],
        [198.335, 263.587, 222.268],
        [198.346, 263.589, 222.239],
        [198.354, 263.594, 222.212],
        [198.358, 263.605, 222.189],
        [198.356, 263.624, 222.170],
        [198.349, 263.649, 222.155],
        [198.339, 263.681, 222.144],
        [198.325, 263.719, 222.136],
        [198.310, 263.761, 222.132],
        [198.293, 263.808, 222.130],
        [198.277, 263.859, 222.132],
        [198.261, 263.913, 222.136],
        [198.247, 263.969, 222.142],
        [198.235, 264.027, 222.150],
        [198.227, 264.086, 222.160],
        [198.223, 264.146, 222.171],
        [198.221, 264.207, 222.184],
        [198.220, 264.272, 222.196],
        [198.217, 264.339, 222.208],
        [198.212, 264.411, 222.220],
        [198.202, 264.488, 222.230],
        [198.185, 264.572, 222.238],
        [198.160, 264.662, 222.244],
        [198.126, 264.761, 222.246],
        [198.080, 264.868, 222.245],
        [198.020, 264.985, 222.240],
        [197.946, 265.112, 222.230],
        [197.858, 265.248, 222.217],
        [197.760, 265.390, 222.204],
        [197.652, 265.536, 222.191],
        [197.538, 265.683, 222.182],
        [197.419, 265.830, 222.177],
        [197.298, 265.973, 222.179],
        [197.177, 266.110, 222.191],
        [197.058, 266.239, 222.213],
        [196.942, 266.357, 222.249],
        [196.833, 266.463, 222.299],
        [196.733, 266.554, 222.367],
        [196.641, 266.631, 222.449],
        [196.559, 266.698, 222.541],
        [196.485, 266.758, 222.639],
        [196.420, 266.816, 222.739],
        [196.364, 266.874, 222.835],
        [196.317, 266.936, 222.925],
        [196.278, 267.006, 223.002],
        [196.248, 267.087, 223.063],
        [196.226, 267.184, 223.103],
        [196.212, 267.299, 223.118],
        [196.206, 267.436, 223.104],
        [196.208, 267.595, 223.058],
        [196.217, 267.774, 222.985],
        [196.233, 267.969, 222.888],
        [196.254, 268.175, 222.771],
        [196.281, 268.389, 222.637],
        [196.313, 268.608, 222.489],
        [196.349, 268.827, 222.331],
        [196.389, 269.043, 222.167],
        [196.432, 269.253, 222.000],
        [196.477, 269.452, 221.833],
        [196.523, 269.637, 221.671],
        [196.571, 269.806, 221.515],
        [196.620, 269.958, 221.367],
        [196.668, 270.094, 221.227],
        [196.716, 270.215, 221.095],
        [196.762, 270.323, 220.971],
        [196.806, 270.418, 220.855],
        [196.847, 270.500, 220.749],
        [196.885, 270.571, 220.652],
        [196.919, 270.632, 220.564],
        [196.948, 270.683, 220.486],
        [196.971, 270.725, 220.417],
        [196.988, 270.759, 220.359],
        [197.000, 270.787, 220.310],
        [197.007, 270.809, 220.269],
        [197.010, 270.828, 220.236],
        [197.010, 270.843, 220.209],
        [197.006, 270.857, 220.186],
        [197.001, 270.871, 220.168],
        [196.994, 270.885, 220.153],
        [196.987, 270.903, 220.139],
        [196.980, 270.923, 220.127],
        [196.974, 270.949, 220.113],
        [196.970, 270.981, 220.099],
        [196.968, 271.019, 220.083],
        [196.967, 271.063, 220.065],
        [196.968, 271.112, 220.046],
        [196.971, 271.165, 220.026],
        [196.976, 271.222, 220.005],
        [196.983, 271.282, 219.983],
        [196.991, 271.345, 219.960],
        [197.001, 271.410, 219.936],
        [197.012, 271.475, 219.913],
        [197.026, 271.541, 219.889],
        [197.040, 271.607, 219.865],
        [197.056, 271.673, 219.842],
        [197.073, 271.739, 219.820],
        [197.089, 271.806, 219.799],
        [197.105, 271.874, 219.780],
        [197.120, 271.946, 219.764],
        [197.133, 272.020, 219.751],
        [197.144, 272.099, 219.742],
        [197.151, 272.182, 219.738],
        [197.155, 272.271, 219.739],
        [197.154, 272.366, 219.746],
        [197.149, 272.468, 219.759],
        [197.138, 272.577, 219.778],
        [197.123, 272.694, 219.801],
        [197.106, 272.817, 219.825],
        [197.087, 272.947, 219.846],
        [197.068, 273.082, 219.861],
        [197.051, 273.224, 219.868],
        [197.037, 273.370, 219.863],
        [197.027, 273.521, 219.843],
        [197.023, 273.677, 219.805],
        [197.026, 273.836, 219.746],
        [197.038, 273.999, 219.663],
        [197.059, 274.164, 219.553],
        [197.089, 274.333, 219.418],
        [197.122, 274.506, 219.264],
        [197.157, 274.683, 219.093],
        [197.188, 274.864, 218.912],
        [197.214, 275.050, 218.723],
        [197.231, 275.241, 218.533],
        [197.234, 275.438, 218.344],
        [197.222, 275.641, 218.163],
        [197.189, 275.850, 217.992],
        [197.134, 276.066, 217.836],
        [197.052, 276.289, 217.701],
        [196.944, 276.517, 217.587],
        [196.815, 276.748, 217.492],
        [196.670, 276.976, 217.416],
        [196.513, 277.198, 217.356],
        [196.349, 277.411, 217.312],
        [196.183, 277.611, 217.280],
        [196.020, 277.793, 217.261],
        [195.864, 277.955, 217.252],
        [195.721, 278.093, 217.251],
        [195.594, 278.202, 217.258],
        [195.490, 278.279, 217.270],
        [195.409, 278.323, 217.285],
        [195.351, 278.341, 217.303],
        [195.313, 278.339, 217.322],
        [195.293, 278.323, 217.339],
        [195.289, 278.300, 217.354],
        [195.297, 278.277, 217.364],
        [195.316, 278.260, 217.367],
        [195.344, 278.256, 217.363],
        [195.377, 278.272, 217.349],
        [195.414, 278.314, 217.324],
        [195.453, 278.388, 217.286],
        [195.490, 278.500, 217.234],
        [195.526, 278.646, 217.171],
        [195.559, 278.821, 217.098],
        [195.590, 279.017, 217.019],
        [195.618, 279.230, 216.937],
        [195.642, 279.454, 216.855],
        [195.662, 279.682, 216.776],
        [195.677, 279.909, 216.702],
        [195.687, 280.129, 216.637],
        [195.692, 280.337, 216.584],
        [195.690, 280.526, 216.545],
        [195.682, 280.690, 216.522],
        [195.669, 280.830, 216.516],
        [195.651, 280.944, 216.524],
        [195.631, 281.036, 216.541],
        [195.611, 281.105, 216.566],
        [195.593, 281.154, 216.595],
        [195.577, 281.183, 216.626],
        [195.566, 281.193, 216.655],
        [195.562, 281.186, 216.680],
        [195.566, 281.162, 216.698],
        [195.580, 281.123, 216.705],
        [195.605, 281.070, 216.700],
        [195.641, 281.007, 216.681],
        [195.683, 280.941, 216.655],
        [195.725, 280.877, 216.626],
        [195.763, 280.823, 216.598],
        [195.792, 280.786, 216.577],
        [195.808, 280.773, 216.567],
        [195.804, 280.789, 216.574],
        [195.777, 280.843, 216.601],
        [195.722, 280.940, 216.655],
        [195.633, 281.088, 216.739],
        [195.505, 281.294, 216.859],
        [195.337, 281.559, 217.016],
        [195.136, 281.875, 217.205],
        [194.908, 282.231, 217.419],
        [194.661, 282.616, 217.652],
        [194.403, 283.019, 217.896],
        [194.141, 283.429, 218.145],
        [193.883, 283.836, 218.391],
        [193.636, 284.229, 218.628],
        [193.407, 284.596, 218.850],
        [193.205, 284.928, 219.049],
        [193.037, 285.213, 219.218],
        [192.908, 285.442, 219.353],
        [192.817, 285.619, 219.454],
        [192.760, 285.749, 219.526],
        [192.732, 285.839, 219.572],
        [192.727, 285.895, 219.597],
        [192.742, 285.925, 219.605],
        [192.772, 285.934, 219.599],
        [192.813, 285.929, 219.584],
        [192.858, 285.918, 219.564],
        [192.905, 285.905, 219.543],
        [192.948, 285.898, 219.525],
        [192.983, 285.903, 219.514],
        [193.009, 285.921, 219.511],
        [193.027, 285.951, 219.514],
        [193.038, 285.989, 219.523],
        [193.042, 286.034, 219.538],
        [193.042, 286.083, 219.556],
        [193.039, 286.134, 219.577],
        [193.033, 286.185, 219.600],
        [193.026, 286.234, 219.623],
        [193.019, 286.278, 219.647],
        [193.013, 286.315, 219.669],
        [193.009, 286.343, 219.689],
        [193.008, 286.361, 219.707],
        [193.009, 286.370, 219.722],
        [193.010, 286.374, 219.736],
        [193.011, 286.372, 219.748],
        [193.010, 286.368, 219.758],
        [193.007, 286.363, 219.769],
        [193.000, 286.358, 219.778],
        [192.988, 286.356, 219.789],
        [192.971, 286.359, 219.799],
        [192.948, 286.367, 219.811],
        [192.917, 286.384, 219.824],
        [192.877, 286.410, 219.838],
        [192.831, 286.443, 219.854],
        [192.779, 286.483, 219.871],
        [192.722, 286.527, 219.890],
        [192.663, 286.575, 219.909],
        [192.603, 286.623, 219.929],
        [192.543, 286.671, 219.950],
        [192.485, 286.717, 219.970],
        [192.430, 286.759, 219.991],
        [192.380, 286.796, 220.012],
        [192.336, 286.825, 220.033],
        [192.298, 286.846, 220.053],
        [192.267, 286.859, 220.072],
        [192.239, 286.867, 220.090],
        [192.213, 286.870, 220.108],
        [192.184, 286.872, 220.125],
        [192.152, 286.874, 220.140],
        [192.114, 286.877, 220.155],
        [192.067, 286.884, 220.168],
        [192.009, 286.897, 220.179],
        [191.938, 286.916, 220.189],
        [191.851, 286.946, 220.198],
        [191.745, 286.986, 220.204],
        [191.621, 287.038, 220.209],
        [191.482, 287.100, 220.210],
        [191.330, 287.172, 220.209],
        [191.168, 287.253, 220.203],
        [190.998, 287.341, 220.192],
        [190.822, 287.436, 220.177],
        [190.644, 287.536, 220.155],
        [190.466, 287.641, 220.127],
        [190.290, 287.750, 220.092],
        [190.119, 287.862, 220.049],
        [189.955, 287.976, 219.998],
        [189.801, 288.090, 219.938],
        [189.657, 288.205, 219.871],
        [189.522, 288.318, 219.799],
        [189.396, 288.430, 219.722],
        [189.281, 288.540, 219.641],
        [189.176, 288.646, 219.559],
        [189.081, 288.748, 219.476],
        [188.996, 288.844, 219.393],
        [188.922, 288.935, 219.313],
        [188.858, 289.019, 219.235],
        [188.804, 289.096, 219.163],
        [188.761, 289.164, 219.095],
        [188.728, 289.225, 219.033],
        [188.704, 289.278, 218.976],
        [188.686, 289.325, 218.923],
        [188.676, 289.366, 218.873],
        [188.670, 289.402, 218.827],
        [188.668, 289.434, 218.783],
        [188.670, 289.462, 218.741],
        [188.674, 289.487, 218.700],
        [188.678, 289.509, 218.660],
        [188.682, 289.530, 218.621],
        [188.685, 289.549, 218.582],
        [188.687, 289.568, 218.542],
        [188.688, 289.586, 218.504],
        [188.688, 289.602, 218.469],
        [188.690, 289.617, 218.436],
        [188.692, 289.631, 218.407],
        [188.696, 289.643, 218.384],
        [188.702, 289.653, 218.366],
        [188.711, 289.662, 218.355],
        [188.724, 289.668, 218.351],
        [188.740, 289.673, 218.357],
        [188.761, 289.675, 218.372],
        [188.785, 289.675, 218.394],
        [188.809, 289.674, 218.421],
        [188.832, 289.673, 218.446],
        [188.851, 289.672, 218.466],
        [188.862, 289.673, 218.476],
        [188.863, 289.675, 218.472],
        [188.851, 289.681, 218.449],
        [188.823, 289.689, 218.403],
        [188.778, 289.702, 218.329],
        [188.712, 289.721, 218.223],
        [188.621, 289.745, 218.080],
        [188.507, 289.775, 217.900],
    ],
}


RCSB_ID     = "6Z6K"
RIBETL_DATA = '/home/rtviii/dev/RIBETL_DATA'




def parse_struct_via_centerline()->list:
    """return list of atoms"""
    parser      = MMCIFParser()
    struct_path = "{}/{}/{}.cif".format(RIBETL_DATA,RCSB_ID, RCSB_ID)
    structure   = parser.get_structure(RCSB_ID, struct_path)

    atoms       = Selection.unfold_entities(structure, "A")
    ns          = NeighborSearch(atoms)
    coordinates = refined_tunnel_coordinates["6Z6K"]

    nearby_atoms_list = []
    for coord in coordinates:
        nearby_atoms      = ns.search(coord, 15.0, 'A')  # 10.0 is the distance in angstroms
        nearby_atoms_list = list(nearby_atoms)
    return nearby_atoms_list

def encode_atoms(nearby_atoms_list:list):

    atom_radii = {
    # element: vwd_radius
    }
    atom_encodings =  {

        # C : 1
        # N : 2
    }

    coordinates = []
    encodings   = []
    for atom in nearby_atoms_list:
        COORD     = atom.get_coord()
        atom_type = atom.element
        if atom_type not in atom_radii:
            atom_radii[atom_type] = element(atom_type).vdw_radius/100
        if atom_type not in atom_encodings:
            atom_encodings[atom_type] = len( atom_encodings.keys ()) + 1
         
        VDW_R       = atom_radii[atom_type]
        encoding_id = atom_encodings[atom_type]

        coordinates.append(COORD)
        encodings.append([VDW_R, encoding_id, 0])


    encodings_dict = {
        **atom_radii,
        **atom_encodings,
        "coordinates"   : coordinates,
        "radius_types_0": encodings
    }
    return encodings_dict



def create_pcd_from_atoms(positions:np.ndarray, atom_types:np.ndarray, save_path:str):
    pcd = o3d.geometry.PointCloud( o3d.utility.Vector3dVector(positions) )
    pcd.colors = o3d.utility.Vector3dVector(atom_types)
    o3d.io.write_point_cloud(save_path, pcd)


atoms          = parse_struct_via_centerline()
encodings_dict = encode_atoms(atoms)
coordinates    = encodings_dict["coordinates"]
colors         = encodings_dict["radius_types_0"]
encodings_path = 'home/rtviii/dev/open3d_mesh/encodings/{}.json'.format(RCSB_ID)

with open(encodings_path, 'w') as fp:
    json.dump(encodings_dict, fp)

create_pcd_from_atoms(coordinates, colors, "home/rtviii/dev/open3d_mesh/encodings/{}.json".format(RCSB_ID))

# n = np.vstack((nbhd))

# point_cloud = o3d.geometry.PointCloud()
# point_cloud.points = o3d.utility.Vector3dVector(nbhd)
# point_cloud.labels = o3d.utility.Vector3dVector([np.random.random(4) for x in range(len(nbhd))], o3c.float32)
# o3d.io.write_point_cloud("refined_{}.pcd".format(RCSB_ID), point_cloud)
# print("Wrote refined_{}.pcd successfully".format(RCSB_ID))

# pcd = o3d.io.read_point_cloud("./refined_{}.pcd".format(RCSB_ID))
# o3d.visualization.draw_geometries([pcd])